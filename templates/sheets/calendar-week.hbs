<div class="calendar-week-view">
  {{#if calendarData}}
    <div class="week-grid"
      style="grid-template-rows: var(--calendaria-week-header-height) repeat({{calendarData.daysInWeek}}, var(--calendaria-week-hour-height));">
      <!-- Empty corner cell -->
      <div class="week-corner-header"></div>

      <!-- Hour labels row -->
      {{#each calendarData.timeSlots}}
        <div class="week-hour-label">{{label}}</div>
      {{/each}}

      <!-- Day rows -->
      {{#each calendarData.days}}
        <!-- Day name cell -->
        <div class="week-day-header {{#if isToday}}today{{/if}}">
          <span class="day-header-text"><strong>{{day}}</strong> - {{dayName}}</span>
        </div>

        <!-- Hour grid cells for this day -->
        {{#each ../calendarData.timeSlots}}
          <div
            class="week-time-cell {{#if (and ../isToday (eq hour ../currentHour))}}current-hour{{/if}}{{#if (eq hour ../selectedHour)}} selected{{/if}}"
            data-day="{{../day}}" data-month="{{../month}}" data-year="{{../year}}" data-hour="{{hour}}"
            data-action="selectTimeSlot">
            <!-- Event blocks positioned within cells -->
            {{#each ../eventBlocks}}
              {{#if (eq ../hour startHour)}}
                <div class="week-event-block {{#if allDay}}all-day{{/if}} {{#if (eq hourSpan 1)}}compact{{/if}}"
                  style="--hour-span: {{hourSpan}}; background-color: {{color}};"
                  data-tooltip="{{name}}: {{startTime}}{{#if endTime}} - {{endTime}}{{/if}}" data-action="editNote"
                  data-note-id="{{id}}">
                  <div class="event-icon">
                    {{#if (eq iconType "fontawesome")}}
                      <i class="{{icon}}"></i>
                    {{else if icon}}
                      <img src="{{icon}}" alt="{{name}}" />
                    {{/if}}
                  </div>
                  <div class="event-name">{{name}}</div>
                </div>
              {{/if}}
            {{/each}}
          </div>
        {{/each}}
      {{/each}}
    </div>
  {{else}}
    <div class="no-calendar">
      <p>No calendar configured. Select a calendar in the settings.</p>
    </div>
  {{/if}}
</div>
